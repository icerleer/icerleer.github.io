<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LOME LEE</title>
  
  <subtitle>LOME LEE BLOG</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.lomelee.com/"/>
  <updated>2018-01-23T13:45:13.000Z</updated>
  <id>http://www.lomelee.com/</id>
  
  <author>
    <name>[object Object]</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>新的开始</title>
    <link href="http://www.lomelee.com/2018/01/23/new-life/"/>
    <id>http://www.lomelee.com/2018/01/23/new-life/</id>
    <published>2018-01-23T13:45:13.000Z</published>
    <updated>2018-01-23T13:45:13.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="新的开始"><a href="#新的开始" class="headerlink" title="新的开始"></a>新的开始</h4><p>兜兜转转2018的第一个月已经快过完了，我像个被压扁的不倒翁一样，慢慢的站起来，觉得新的我来了，或者说回到我想要的那个自己，更为贴切。<br>或许人总是需要那么长时间思考，自我压抑，才知道该怎么做。</p><h4 id="2018的我"><a href="#2018的我" class="headerlink" title="2018的我"></a>2018的我</h4><p>这几年，随着年纪变大，越来越觉得自己的脾气暴躁了，2018我要静下来。</p><p>时间总是这么悄无声息的偷偷的走，我要抓紧时间学习了，再不学习就真的老了，2018我要学习产品，并且自己做一个像样的产品。</p><p>技术这条路走了这么久，有人说程序员不能做太久，得承认是这样的，激情和经历总是属于年轻人，但是我并不认同老程序员没有优点，<br>2018我要深度去研究一项技术</p><h4 id="以后的生活"><a href="#以后的生活" class="headerlink" title="以后的生活"></a>以后的生活</h4><p>2017 收获最大的就应该是房子的事情了，算是再这个城市有了一个自己的家。昨天刚刚搬新家，希望以后的一家人生活，都平安健康。</p><h4 id="改掉那些臭毛病"><a href="#改掉那些臭毛病" class="headerlink" title="改掉那些臭毛病"></a>改掉那些臭毛病</h4><p>懒惰，空想，不切实际，话多，内心浮躁。 </p><h4 id="加油"><a href="#加油" class="headerlink" title="加油"></a>加油</h4><p>加油，为以后的生活加油，为更好的我加油，2018 做回真正的我。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;新的开始&quot;&gt;&lt;a href=&quot;#新的开始&quot; class=&quot;headerlink&quot; title=&quot;新的开始&quot;&gt;&lt;/a&gt;新的开始&lt;/h4&gt;&lt;p&gt;兜兜转转2018的第一个月已经快过完了，我像个被压扁的不倒翁一样，慢慢的站起来，觉得新的我来了，或者说回到我想要的那个自己，
      
    
    </summary>
    
      <category term="人生" scheme="http://www.lomelee.com/categories/%E4%BA%BA%E7%94%9F/"/>
    
    
      <category term="感悟" scheme="http://www.lomelee.com/tags/%E6%84%9F%E6%82%9F/"/>
    
  </entry>
  
  <entry>
    <title>java 实现自动锁</title>
    <link href="http://www.lomelee.com/2017/09/01/java-autolock/"/>
    <id>http://www.lomelee.com/2017/09/01/java-autolock/</id>
    <published>2017-09-01T13:22:05.000Z</published>
    <updated>2017-09-01T13:22:05.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li>了解自动锁</li></ul><p>很早就受不了 java 锁的机制了,每次都需要在 finally 去解锁, 不仅代码不美观,而且很麻烦</p><p>我想能不能实现加锁之后自动解锁, 如果是C++ 可以利用析构函数实现, 但java就…….</p><p>想了想好像可以利用java7 的 try-with-resource 特性, 对象只需要实现 AutoCloseable 接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AutoLock</span> <span class="keyword">implements</span> <span class="title">AutoCloseable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="comment">// other function start</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ........</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// other function end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// I like this feature</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        unLock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>实现自动锁</li></ul><p>我了解如何利用java特性写一个自动锁那么, 下面我们开始真正的实现</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自动锁实现类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoLock</span> <span class="keyword">implements</span> <span class="title">AutoCloseable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 重入锁对象</span></span><br><span class="line">    <span class="keyword">private</span> ReentrantLock reentrantLock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自动锁 加锁</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回自动锁本身</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AutoLock <span class="title">lock</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 加锁</span></span><br><span class="line">        reentrantLock.lock();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AutoLock <span class="title">getAutoLock</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> AutoLock().lock();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自动锁解锁</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回自动锁本身</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> AutoLock <span class="title">unLock</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 解锁</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != reentrantLock &amp;&amp; reentrantLock.isLocked())</span><br><span class="line">        &#123;</span><br><span class="line">            reentrantLock.unlock();           </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        unLock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 简单, 调用示例</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAutoLock</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">try</span>(AutoLock autoLock = <span class="keyword">new</span> AutoLock())</span><br><span class="line">&#123;</span><br><span class="line">autoLock.lock()</span><br><span class="line"><span class="comment">// do some thing.....</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不用再解锁了, 不用再解锁了, 不用再解锁了!!!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更方便的调用示例</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAutoLock</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// 使用静态方法</span></span><br><span class="line"><span class="keyword">try</span>(AutoLock autoLock = AutoLock.getAutoLock())</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// do some thing.....</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不用再解锁了, 不用再解锁了, 不用再解锁了!!!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>自动锁的使用场景</li></ul><p>前面两种调用方式, 只是打个比方, 但是很多时候,我们的需求并不是 每次都需要 new ReentrantLock(), 这样并没有什么N用的, 因为每次新的”重入锁”实例, 起不到防止重入的目的, 那我们改变一下方式, 我们做两个地方的改变, 我们修改reentrantLock 成员不做初始化new, 而是通过参数传入Lock 抽象接口对象<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自动锁实现类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoLock</span> <span class="keyword">implements</span> <span class="title">AutoCloseable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// *重入锁对象 (改变1)*</span></span><br><span class="line">    <span class="keyword">private</span> Lock autoLock = <span class="keyword">null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// *重写构造函数(改变2)*</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="title">AutoLock</span><span class="params">(Lock autoLock)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">this</span>.autoLock = autoLock;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自动锁 加锁</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回自动锁本身</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AutoLock <span class="title">lock</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// *加锁(改变3)*</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != reentrantLock)</span><br><span class="line">        &#123;</span><br><span class="line">        reentrantLock.lock();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// *获取自动锁对象 (改变4)*</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AutoLock <span class="title">getAutoLock</span><span class="params">(Lock autoLock)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> AutoLock(autoLock).lock();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自动锁解锁</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回自动锁本身</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> AutoLock <span class="title">unLock</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 解锁</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != autoLock)</span><br><span class="line">        &#123;</span><br><span class="line">            autoLock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        unLock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>至于为什么传入的是 Lock 抽象接口, 因为很所时候,我们可能自定义一个锁对象, 或者以后JDK可能提供的其他锁, 我们来看看调用示例吧<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> class <span class="title">TestService</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">private</span> Lock reentrantLock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 假设线程A调用此方法</span></span><br><span class="line"><span class="function">pubilc <span class="keyword">void</span> <span class="title">testAutoLockA</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">try</span>(AutoLock autoLock = AutoLock.getAutoLock(reentrantLock))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// do some thing....</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 假设线程B调用此方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAutoKLockB</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">try</span>(AutoLock autoLock = AutoLock.getAutoLock(reentrantLock))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// do some thing....</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>至此我们就实现了,我们假设的常用场景</p><ul><li><p>更高级的用法</p><p>如果我要更细粒度的锁, 不是在对象的成员中存在锁对象,怎么办.<br>我写一个方法, 希望可以帮助大家, 抛砖引玉, 如果可以提供更好的方式请求留言</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description: TestLock</span></span><br><span class="line"><span class="comment"> * Created by: IcerLeer</span></span><br><span class="line"><span class="comment"> * Created on: 2017-08-31 17:42</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LockUtils</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 自动锁缓存队列, 实现不可重入</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ConcurrentHashMap&lt;String, AutoLock&gt; lockMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取自动锁</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> strKey 自动锁关键字</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回自动锁对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AutoLock <span class="title">getAutoLock</span><span class="params">(String strKey)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (strKey.intern())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> lockMap.computeIfAbsent(strKey, key -&gt; <span class="keyword">new</span> AutoLock(strKey)).lock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 移除自动锁</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> strKey 自动锁关键字</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">removeAutoLock</span><span class="params">(String strKey)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        lockMap.remove(strKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自动锁</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoLock</span> <span class="keyword">implements</span> <span class="title">AutoCloseable</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="comment">// 锁的关键字</span></span><br><span class="line">        <span class="keyword">private</span> String lockKey = <span class="string">""</span>;</span><br><span class="line">        <span class="comment">// 事务锁对象</span></span><br><span class="line">        <span class="keyword">private</span> ReentrantLock reentrantLock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line">        <span class="comment">// 引用计数</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> refNumber = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 初始化构造函数</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">AutoLock</span><span class="params">(String strKey)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotBlank(strKey))</span><br><span class="line">            &#123;</span><br><span class="line">                lockKey = strKey;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 自动锁 加锁</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> 返回自动锁本身</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> AutoLock <span class="title">lock</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">// 增加引用次数</span></span><br><span class="line">            refNumber++;</span><br><span class="line">            <span class="comment">// 加锁</span></span><br><span class="line">            reentrantLock.lock();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 自动锁解锁</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> 返回自动锁本身</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> AutoLock <span class="title">unLock</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">// 解锁</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != reentrantLock &amp;&amp; reentrantLock.isLocked())</span><br><span class="line">            &#123;</span><br><span class="line">                reentrantLock.unlock();</span><br><span class="line">                <span class="comment">// 判断是否应该把自动锁移除队列</span></span><br><span class="line">                <span class="keyword">synchronized</span> (lockKey.intern())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 减少引用次数</span></span><br><span class="line">                    refNumber--;</span><br><span class="line">                    <span class="comment">// 如果引用计数</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="number">0</span> == refNumber)</span><br><span class="line">                    &#123;</span><br><span class="line">                        removeAutoLock(lockKey);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            unLock();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当然少不了调用示例<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">testAutoLockA</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">/// "Test" 为锁的关键字, 相同的关键字实现不可重入锁</span></span><br><span class="line">    <span class="keyword">try</span>(LockUtils.AutoLock autoLock = LockUtils.getAutoLock(<span class="string">"Test"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// do some thing</span></span><br><span class="line">sleep(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">testAutoLockB</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">/// "Test" 为锁的关键字, 相同的关键字实现不可重入锁</span></span><br><span class="line">    <span class="keyword">try</span>(LockUtils.AutoLock autoLock = LockUtils.getAutoLock(<span class="string">"Test"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// do some thing</span></span><br><span class="line">sleep(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;了解自动锁&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;很早就受不了 java 锁的机制了,每次都需要在 finally 去解锁, 不仅代码不美观,而且很麻烦&lt;/p&gt;
&lt;p&gt;我想能不能实现加锁之后自动解锁, 如果是C++ 可以利用析构函数实现, 但java就…….&lt;/p&gt;
&lt;p
      
    
    </summary>
    
      <category term="技术" scheme="http://www.lomelee.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="java" scheme="http://www.lomelee.com/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>Electron 开发镜像配置</title>
    <link href="http://www.lomelee.com/2016/11/01/electron-mirror/"/>
    <id>http://www.lomelee.com/2016/11/01/electron-mirror/</id>
    <published>2016-11-01T15:17:55.000Z</published>
    <updated>2016-11-01T15:17:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>electron 开发时, 如果你在国内, 你会痛苦的要死, 因为开发下载很慢或者无法下载, 还好有可爱的NPM 淘宝镜像</p><h2 id="以下两个方案"><a href="#以下两个方案" class="headerlink" title="以下两个方案"></a>以下两个方案</h2><h3 id="1-以下添加以下设置"><a href="#1-以下添加以下设置" class="headerlink" title="1. 以下添加以下设置"></a>1. 以下添加以下设置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 注册模块镜像</span><br><span class="line">npm set registry https://registry.npm.taobao.org </span><br><span class="line"># node-gyp 编译依赖的 node 源码镜像</span><br><span class="line">npm set disturl https://npm.taobao.org/dist</span><br><span class="line"></span><br><span class="line">## 以下选择添加</span><br><span class="line"># chromedriver 二进制包镜像</span><br><span class="line">npm set chromedriver_cdnurl http://cdn.npm.taobao.org/dist/chromedriver </span><br><span class="line"># operadriver 二进制包镜像</span><br><span class="line">npm set operadriver_cdnurl http://cdn.npm.taobao.org/dist/operadriver</span><br><span class="line"># phantomjs 二进制包镜像</span><br><span class="line">npm set phantomjs_cdnurl http://cdn.npm.taobao.org/dist/phantomjs </span><br><span class="line"># node-sass 二进制包镜像</span><br><span class="line">npm set sass_binary_site http://cdn.npm.taobao.org/dist/node-sass </span><br><span class="line"># electron 二进制包镜像</span><br><span class="line">npm set electron_mirror http://cdn.npm.taobao.org/dist/electron/</span><br><span class="line"># 清空缓存</span><br><span class="line">npm cache clean</span><br></pre></td></tr></table></figure><h3 id="更方便的设置"><a href="#更方便的设置" class="headerlink" title="更方便的设置"></a>更方便的设置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https://registry.npm.taobao.org  </span><br><span class="line">npm config set disturl https://npm.taobao.org/dist</span><br><span class="line">npm config set NVM_NODEJS_ORG_MIRROR http://npm.taobao.org/mirrors/node  </span><br><span class="line">npm config set NVM_IOJS_ORG_MIRROR http://npm.taobao.org/mirrors/iojs  </span><br><span class="line">npm config set PHANTOMJS_CDNURL https://npm.taobao.org/dist/phantomjs  </span><br><span class="line">npm config set ELECTRON_MIRROR http://npm.taobao.org/mirrors/electron/  </span><br><span class="line">npm config set SASS_BINARY_SITE http://npm.taobao.org/mirrors/node-sass  </span><br><span class="line">npm config set SQLITE3_BINARY_SITE http://npm.taobao.org/mirrors/sqlite3  </span><br><span class="line">npm config set PYTHON_MIRROR http://npm.taobao.org/mirrors/python</span><br></pre></td></tr></table></figure><h3 id="2-安装-CNPM"><a href="#2-安装-CNPM" class="headerlink" title="2. 安装 CNPM"></a>2. 安装 CNPM</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;electron 开发时, 如果你在国内, 你会痛苦的要死, 因为开发下载很慢或者无法下载, 还好有可爱的NPM 淘宝镜像&lt;/p&gt;
&lt;h2 id=&quot;以下两个方案&quot;&gt;&lt;a href=&quot;#以下两个方案&quot; class=&quot;headerlink&quot; title=&quot;以下两个方案&quot;&gt;&lt;/a
      
    
    </summary>
    
      <category term="技术" scheme="http://www.lomelee.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="electron" scheme="http://www.lomelee.com/tags/electron/"/>
    
      <category term="mirror" scheme="http://www.lomelee.com/tags/mirror/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7 + mysqlcluster 配置部署</title>
    <link href="http://www.lomelee.com/2015/08/12/centos7-mysqlcluster/"/>
    <id>http://www.lomelee.com/2015/08/12/centos7-mysqlcluster/</id>
    <published>2015-08-11T17:12:05.000Z</published>
    <updated>2015-08-11T17:12:05.000Z</updated>
    
    <content type="html"><![CDATA[<p>前后折腾了4天终于把这个东西东西配置好了。吐槽一下，网上的很多资料虽然按照其指定的方法确实可以在CentOS上配置出可用的Mysql Cluster 但是并没有分清管理节点，数据节点，应用节点的目录和区别，如果就这样糊里糊涂的配置，在生产环境估计使用起来够呛。<br>【注：可能是我没有真正理解这些资料，个人意见而已】</p><p> <strong>1. 参数配置</strong></p><p>很多时候我们都参照网上的并不是很官方的资料，而且并不知道很多参数的含义，所以我找了一个比较比错的方法来生成配置参数, mysql官方在 mysql cluster 7.3 后，做了一个自动化部署的工具,工具很不错。官方的视频地址 <a href="http://www.mysql.com/products/cluster/installer.html" target="_blank" rel="external">http://www.mysql.com/products/cluster/installer.html</a></p><p>启动方式在MYSQL Cluster版本的应用SQL节点程序的bin目录下 运行 ndb_setup.py 会自动跳转到web端配置。[前提是要安装Python]</p><p>我并没有用这个工具来真正的部署mysql cluster , 因为部署前需要配置东西较多，而且不利于真正的理解部署环境。所以只用它来获取配置参数(官方的配置放心些， 而且我们可以更改我们的物理机器配置，来获取不同的数据对比各个参数的变化，更好的理解参数的意义)，在部署的过程中我们可以填写物理服务器的配置以及要使用的实时性应用级别，具体的见官方视频介绍</p><p>我生成的配置数据如下（生成后保存此参数为config.ini文件）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line"># Configuration file for PaiDB MyCluster</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">[NDB_MGMD DEFAULT]</span><br><span class="line">Portnumber=1186</span><br><span class="line"></span><br><span class="line">[NDB_MGMD]</span><br><span class="line">NodeId=49</span><br><span class="line">HostName=192.168.1.45</span><br><span class="line">DataDir=/usr/local/paidb/mysqlmgm/mgmdata</span><br><span class="line">Portnumber=1186</span><br><span class="line"></span><br><span class="line">[TCP DEFAULT]</span><br><span class="line">SendBufferMemory=8M</span><br><span class="line">ReceiveBufferMemory=8M</span><br><span class="line"></span><br><span class="line">[NDBD DEFAULT]</span><br><span class="line">BackupMaxWriteSize=1M</span><br><span class="line">BackupDataBufferSize=16M</span><br><span class="line">BackupLogBufferSize=4M</span><br><span class="line">BackupMemory=20M</span><br><span class="line">BackupReportFrequency=10</span><br><span class="line">MemReportFrequency=30</span><br><span class="line">LogLevelStartup=15</span><br><span class="line">LogLevelShutdown=15</span><br><span class="line">LogLevelCheckpoint=8</span><br><span class="line">LogLevelNodeRestart=15</span><br><span class="line">DataMemory=1630M</span><br><span class="line">IndexMemory=291M</span><br><span class="line">MaxNoOfTables=4096</span><br><span class="line">MaxNoOfTriggers=3500</span><br><span class="line">NoOfReplicas=2</span><br><span class="line">StringMemory=25</span><br><span class="line">DiskPageBufferMemory=64M</span><br><span class="line">SharedGlobalMemory=20M</span><br><span class="line">LongMessageBuffer=32M</span><br><span class="line">MaxNoOfConcurrentTransactions=16384</span><br><span class="line">BatchSizePerLocalScan=512</span><br><span class="line">FragmentLogFileSize=256M</span><br><span class="line">NoOfFragmentLogFiles=9</span><br><span class="line">RedoBuffer=64M</span><br><span class="line">MaxNoOfExecutionThreads=2</span><br><span class="line">StopOnError=false</span><br><span class="line">LockPagesInMainMemory=1</span><br><span class="line">TimeBetweenEpochsTimeout=32000</span><br><span class="line">TimeBetweenWatchdogCheckInitial=60000</span><br><span class="line">TransactionInactiveTimeout=60000</span><br><span class="line">HeartbeatIntervalDbDb=1500</span><br><span class="line">HeartbeatIntervalDbApi=1500</span><br><span class="line"></span><br><span class="line">[NDBD]</span><br><span class="line">NodeId=1</span><br><span class="line">HostName=192.168.1.45</span><br><span class="line">DataDir=/usr/local/paidb/mysqldata/data1</span><br><span class="line">BackupDataDir=/usr/local/paidb/mysqldata/backup1</span><br><span class="line"></span><br><span class="line">[NDBD]</span><br><span class="line">NodeId=2</span><br><span class="line">HostName=192.168.1.40</span><br><span class="line">DataDir=/var/local/paidb/mysqldata/data2</span><br><span class="line">BackupDataDir=/usr/local/paidb/mysqldata/backup2</span><br><span class="line"></span><br><span class="line">[MYSQLD DEFAULT]</span><br><span class="line"></span><br><span class="line">[MYSQLD]</span><br><span class="line">NodeId=50</span><br><span class="line">HostName=192.168.1.45</span><br><span class="line"></span><br><span class="line">[MYSQLD]</span><br><span class="line">NodeId=51</span><br><span class="line">HostName=192.168.1.40</span><br><span class="line"></span><br><span class="line">[API]</span><br><span class="line">NodeId=52</span><br><span class="line">HostName=192.168.1.45</span><br><span class="line"></span><br><span class="line">[API]</span><br><span class="line">NodeId=53</span><br><span class="line">HostName=192.168.1.45</span><br></pre></td></tr></table></figure><p> <strong>2. 配置前准备</strong></p><p>（1）.停止防火墙或者防火墙允许端口1186, 2202, 3306，我为了图方便直接停止防火墙<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl disable firewalld</span><br></pre></td></tr></table></figure></p><p>（2）.解压 mysql cluster 安装包到目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#把我的安装文件放在了 /usr/src/ 文件夹下面</span><br><span class="line">#进入此目录解压</span><br><span class="line">cd /usr/src</span><br><span class="line">tar -zxf mysql-cluster-7.4.6-linux-glibc2.5-x86_64.tar.gz</span><br><span class="line">#简化文件夹名称</span><br><span class="line">mv mysql-cluster-7.4.6-linux-glibc2.5-x86_64 mysqlc</span><br></pre></td></tr></table></figure></p><p>（3）.在用户目录下新建要安装的管理节点，数据节点，应用节点的目录，我这里他们都放在 /usr/local/paidb/ 目录下，为每台机器创建要勇于服务的节点目录， 由于测试机器有限，我在其中一台服务器配置，管理节点，数据节点1，应用节点1；另一台服务器配置数据节点2，应用节点2；<br>下面是我的节点分配情况”()”号内是目录的名称<br>192.168.1.45 –&gt;管理节点(mysqlmgm) —&gt; 数据节点(mysqldata) —&gt;应用节点(mysqlapp)<br>192.168.1.40 –&gt;数据节点(mysqldata)  —&gt; 应用节点(mysqlapp)</p><p>准备工作做好了接下来我们就来配置各个节点的服务了。</p><p> <strong>3. 配置管理节点</strong></p><p> 在192.168.1.45的服务器上配置管理节点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#创建管理节点运行目录和配置完成后的生成文件目录</span><br><span class="line">mkdir -p /usr/local/paidb/mysqlmgm/bin/config</span><br><span class="line">#创建管理节点数据目录</span><br><span class="line">mkdir -p /usr/local/paidb/mysqlmgm/mgmdata</span><br><span class="line">#进入管理节点目录</span><br><span class="line">cd /usr/local/paidb/mysqlmgm</span><br><span class="line">#拷贝管理节点的必要文件到运行目录</span><br><span class="line">mv /usr/src/mysqlc/bin/ndb_mgmd /usr/local/paidb/mysqlmgm/bin/</span><br><span class="line">mv /usr/src/mysqlc/bin/ndb_mgm  /usr/local/paidb/mysqlmgm/bin/</span><br><span class="line"></span><br><span class="line">#拷贝参数配置文件到管理节点运行目录</span><br><span class="line">mv /usr/local/paidb/config.ini /usr/local/paidb/mysqlmgm/bin/config.ini</span><br><span class="line">#把管理节点的运行目录加入环境变量</span><br><span class="line">vim ~/.bash_profile</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#在PATH变量后面增加&quot;:/usr/local/paidb/mysqlmgm/bin&quot;,如下形式：</span><br><span class="line">PATH=$PATH:$HOME/bin:/usr/local/paidb/mysqlmgm/bin</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#退出VIM，使用命令，让环境变量立即生效</span><br><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure><p>到此管理节点就算配置完成了</p><p><strong>4. 配置数据节点</strong></p><p>分别在192.168.1.45， 192.168.1.40上配置数据节点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#192.168.1.45上创建数据节点所需目录</span><br><span class="line">mkdir -p /usr/local/paidb/mysqldata/bin/</span><br><span class="line">mkdir /usr/local/paidb/mysqldata/data1</span><br><span class="line">mkdir /usr/local/paidb/mysqldata/backup1</span><br><span class="line"></span><br><span class="line">#192.168.1.40上创建数据节点所需目录</span><br><span class="line">mkdir -p /usr/local/paidb/mysqldata/bin/</span><br><span class="line">mkdir /usr/local/paidb/mysqldata/data2</span><br><span class="line">mkdir /usr/local/paidb/mysqldata/backup2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#两台机器上都做以下操作</span><br><span class="line">#进入数据节点的运行目录</span><br><span class="line">cd /usr/local/paidb/mysqldata/bin</span><br><span class="line">#拷贝必要的程序到运行目录</span><br><span class="line">mv /usr/src/mysqlc/bin/ndbd    /usr/local/paidb/mysqldata/bin/</span><br><span class="line">mv /usr/src/mysqlc/bin/ndbmtd  /usr/local/paidb/mysqldata/bin/</span><br></pre></td></tr></table></figure><p>编写配置文件如下，文件命名为：my_data.cnf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[mysql_cluster] </span><br><span class="line"># Options for data node process: </span><br><span class="line"># location of management server</span><br><span class="line">ndb-connectstring=192.168.1.45:1186,</span><br></pre></td></tr></table></figure></p><p>拷贝 my_data.cnf 文件到 /usr/local/paidb/mysqldata/bin/ 目录下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#把数据节点的运行目录加入环境变量</span><br><span class="line">vim ~/.bash_profile</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#在PATH变量后面增加&quot;:/usr/local/paidb/mysqldata/bin&quot;;</span><br><span class="line"># 如下形式：</span><br><span class="line">PATH=$PATH:$HOME/bin:/usr/local/paidb/mysqlmgm/bin:/usr/local/paidb/mysqldata/bin</span><br><span class="line"># 或</span><br><span class="line">PATH=$PATH:$HOME/bin:/usr/local/paidb/mysqldata/bin</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#退出VIM，使用命令，让环境变量立即生效</span><br><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure><p>到此两个数据节点配置完成</p><p><strong>5. 配置 mysql 应用节点</strong></p><p>相对复杂一点，接下来看配置<br>分别在192.168.1.45， 192.168.1.40上配置应用节点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#创建应用节点所需目录</span><br><span class="line">mkdir -p /usr/local/paidb/mysqlapp/</span><br><span class="line">mkdir /usr/local/paidb/mysqlapp/data</span><br><span class="line">mkdir /usr/local/paidb/mysqlapp/log</span><br><span class="line">mkdir /usr/local/paidb/mysqlapp/socket</span><br><span class="line">mkdir /usr/local/paidb/mysqlapp/tmp</span><br><span class="line"></span><br><span class="line">#复所需运行文件到应用节点目录</span><br><span class="line">mv /usr/src/mysqlc    /usr/local/paidb/mysqlapp/app/</span><br><span class="line"></span><br><span class="line">#目录转到mysql应用节点运行目录</span><br><span class="line">cd /usr/local/paidb/mysqlapp/app/</span><br><span class="line">#创建mysql实例</span><br><span class="line">./scripts/mysql_install_db --basedir=/usr/local/paidb/mysqlapp/app --datadir=/usr/local/paidb/mysqlapp/data</span><br><span class="line"># 如果出现:FATAL ERROR: please install the following Perl modules before executing ./scripts/mysql_install_db:Data::Dumper，请安装 perl-module  </span><br><span class="line">yum install -y perl-Module-Install.noarch  </span><br><span class="line">#再创建mysql实例</span><br><span class="line">./scripts/mysql_install_db --basedir=/usr/local/paidb/mysqlapp/app --datadir=/usr/local/paidb/mysqlapp/data</span><br></pre></td></tr></table></figure></p><p>创建 mysql 应用节点配置文件, 命名问my_app.cnf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">ndbcluster=on</span><br><span class="line">port=3306</span><br><span class="line">log-error=/usr/local/paidb/mysqlapp/mysqld.err</span><br><span class="line">basedir=/usr/local/paidb/mysqlapp/app</span><br><span class="line">datadir=/usr/local/paidb/mysqlapp/data</span><br><span class="line">tmpdir=/usr/local/paidb/mysqlapp/tmp</span><br><span class="line">ndb-connectstring=192.168.1.45:1186,</span><br><span class="line">socket=/usr/local/paidb/mysqlapp/socket/mysql.socket</span><br></pre></td></tr></table></figure></p><p>拷贝 my_app.cnf 文件到 /usr/local/paidb/mysqlapp/app/ 目录下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#把应用节点的运行目录加入环境变量</span><br><span class="line">vim ~/.bash_profile</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#在PATH变量后面增加&quot;:/usr/local/paidb/mysqlapp/app/bin&quot;;</span><br><span class="line"># 如下形式：</span><br><span class="line">PATH=$PATH:$HOME/bin:/usr/local/paidb/mysqlmgm/bin:/usr/local/paidb/mysqldata/bin:/usr/local/paidb/mysqlapp/app/bin</span><br><span class="line"># 或</span><br><span class="line">PATH=$PATH:$HOME/bin:/usr/local/paidb/mysqldata/bin:/usr/local/paidb/mysqlapp/app/bin</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#退出VIM，使用命令，让环境变量立即生效</span><br><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure><p>到此为止应用节点配置算是完成了。</p><p><strong>6. 运行各个节点服务</strong></p><p>（1）先启动管理节点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#第一次启动是使用</span><br><span class="line">ndb_mgmd -f /usr/local/paidb/mysqlmgm/bin/config.ini --configdir=/usr/local/paidb/mysqlmgm/bin/config --initial</span><br><span class="line"></span><br><span class="line">#以后的每一次启动使用</span><br><span class="line">ndb_mgmd -f /usr/local/paidb/mysqlmgm/bin/config.ini --configdir=/usr/local/paidb/mysqlmgm/bin/config</span><br></pre></td></tr></table></figure><p>（2）然后启动数据节点</p><p>分别在 192.168.1.45 和 192.168.1.40上执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#第一次启动是使用</span><br><span class="line">ndbmtd --defaults-file=/usr/local/paidb/mysqldata/bin/my_data.cnf --initial</span><br><span class="line"></span><br><span class="line">#以后的每一次启动使用</span><br><span class="line">ndbmtd --defaults-file=/usr/local/paidb/mysqldata/bin/my_data.cnf</span><br></pre></td></tr></table></figure><p>（2）最后启动应用节点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#创建启动应用节点所需的符号链接</span><br><span class="line">ln -s /usr/local/paidb/mysqlapp/socket/mysql.socket /tmp/mysql.sock</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#创建mysql用户和组，以启动mysql应用节点服务</span><br><span class="line">groupadd mysql</span><br><span class="line">useradd -g mysql -s /usr/sbin/nologin mysql</span><br><span class="line">#赋值用户和组的权限</span><br><span class="line">chown -R mysql:mysql /usr/local/paidb</span><br></pre></td></tr></table></figure><p>制作 mysql 应用节点服务文件，命名为 mysqlapp.service，以便开机启动,  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=mysqlapp -- mysql cluster API </span><br><span class="line">Before=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStart=/usr/local/paidb/mysqlapp/app/bin/mysqld --defaults-file=/usr/local/paidb/mysqlapp/app/my_app.cnf --user=mysql</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=basic.target</span><br></pre></td></tr></table></figure><p>拷贝此文件到 /usr/lib/systemd/system 目录下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#启动 mysql cluster 应用节点</span><br><span class="line">systemctl start mysqlapp</span><br><span class="line"></span><br><span class="line">#如果要查看当前应用节点运行状态</span><br><span class="line">systemctl status mysqlapp</span><br><span class="line"></span><br><span class="line">#如果要停止应用节点服务</span><br><span class="line">systemctl stop mysqlapp</span><br></pre></td></tr></table></figure><p>到此  mysql cluster 全部部署完成。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;前后折腾了4天终于把这个东西东西配置好了。吐槽一下，网上的很多资料虽然按照其指定的方法确实可以在CentOS上配置出可用的Mysql Cluster 但是并没有分清管理节点，数据节点，应用节点的目录和区别，如果就这样糊里糊涂的配置，在生产环境估计使用起来够呛。&lt;br&gt;【注：
      
    
    </summary>
    
      <category term="技术" scheme="http://www.lomelee.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="linux" scheme="http://www.lomelee.com/tags/linux/"/>
    
      <category term="db" scheme="http://www.lomelee.com/tags/db/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7 firewallD 配置</title>
    <link href="http://www.lomelee.com/2015/06/01/centos7-firewall/"/>
    <id>http://www.lomelee.com/2015/06/01/centos7-firewall/</id>
    <published>2015-06-01T12:00:12.000Z</published>
    <updated>2015-06-01T12:00:12.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="FirewallD-构建简单配置"><a href="#FirewallD-构建简单配置" class="headerlink" title="FirewallD 构建简单配置"></a>FirewallD 构建简单配置</h4><p>比如，要启用或禁用 HTTP 服务： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-service=http --permanent</span><br><span class="line">firewall-cmd --zone=public --remove-service=http --permanent</span><br></pre></td></tr></table></figure><p>比如：允许或者禁用 12345 端口的 TCP 流量。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=12345/tcp --permanent</span><br><span class="line">firewall-cmd --zone=public --remove-port=12345/tcp --permanent</span><br></pre></td></tr></table></figure><h4 id="FirewallD-构建规则集"><a href="#FirewallD-构建规则集" class="headerlink" title="FirewallD 构建规则集"></a>FirewallD 构建规则集</h4><p>允许来自主机 192.168.0.* 的所有 IPv4 流量。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-rich-rule &apos;rule family=&quot;ipv4&quot; source address=192.168.0.0/24 accept&apos;</span><br></pre></td></tr></table></figure><p>拒绝来自主机 192.168.1.10 到 22 端口的 IPv4 的 TCP 流量。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-rich-rule &apos;rule family=&quot;ipv4&quot; source address=&quot;192.168.1.10&quot; port port=22 protocol=tcp reject&apos;</span><br></pre></td></tr></table></figure><p>允许来自主机 10.1.0.3 到 80 端口的 IPv4 的 TCP 流量，并将流量转发到 6532 端口上。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-rich-rule &apos;rule family=ipv4 source address=10.1.0.3 forward-port port=80 protocol=tcp to-port=6532&apos;</span><br></pre></td></tr></table></figure><p>允许UDP组播通过防火墙</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --permanent --direct --add-rule ipv4 filter INPUT 0 -m pkttype --pkt-type multicast -j ACCEPT</span><br><span class="line">firewall-cmd --permanent --direct --add-rule ipv6 filter INPUT 0 -m pkttype --pkt-type multicast -j ACCEPT</span><br></pre></td></tr></table></figure><h4 id="重新加载-Firewall-使配置生效"><a href="#重新加载-Firewall-使配置生效" class="headerlink" title="重新加载 Firewall 使配置生效"></a>重新加载 Firewall 使配置生效</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;FirewallD-构建简单配置&quot;&gt;&lt;a href=&quot;#FirewallD-构建简单配置&quot; class=&quot;headerlink&quot; title=&quot;FirewallD 构建简单配置&quot;&gt;&lt;/a&gt;FirewallD 构建简单配置&lt;/h4&gt;&lt;p&gt;比如，要启用或禁用 HTTP
      
    
    </summary>
    
      <category term="技术" scheme="http://www.lomelee.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="centos" scheme="http://www.lomelee.com/tags/centos/"/>
    
      <category term="linux" scheme="http://www.lomelee.com/tags/linux/"/>
    
      <category term="运维" scheme="http://www.lomelee.com/tags/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>UDP 组播 以及 UDP面向有连接</title>
    <link href="http://www.lomelee.com/2013/07/11/udpconn/"/>
    <id>http://www.lomelee.com/2013/07/11/udpconn/</id>
    <published>2013-07-11T13:45:13.000Z</published>
    <updated>2013-06-01T13:45:13.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="组播IP地址的使用范围规定"><a href="#组播IP地址的使用范围规定" class="headerlink" title="组播IP地址的使用范围规定"></a>组播IP地址的使用范围规定</h4><p>组播报文的目的地址使用 d 类 ip 地址，d 类地址不能出现在 ip 报文的源 ip 地址字段。 </p><p>范围是从 224.0.0.0 到 239.255.255.255。</p><p>其中 224.0.0.0～224.0.0.255 为预留的组播地址（永久组地址） 只能用于局域网中，路由器是不会转发的地址。</p><p>224.0.0.0 保留不做分配，其它地址供路由协议使用。</p><p>224.0.1.0～238.255.255.255 为用户可用的组播地址（临时组地址），可以用于 Internet 上的。</p><p>239.0.0.0～239.255.255.255 为本地管理组播地址，仅在特定的本地范围内有效。</p><h4 id="UDP-进行-connect-面向连接"><a href="#UDP-进行-connect-面向连接" class="headerlink" title="UDP 进行 connect (面向连接)"></a>UDP 进行 connect (面向连接)</h4><p>UDP也是一样可以进行connect的，和TCP的区别在于没有三次握手而已，<br>但是同样也是可以使用send,recv来进行同通信，并且这么做还有一些其他的好处，<br>这些内容在《UNIX网络编程》里说得很清楚，这里我就不细说，只是稍微提一下UDP进行了connect连接的好处， </p><p>在末连接UDP套接字上给两个数据报调用函数sendto导致内核执行下列六步： </p><ul><li>1.连接套接字； </li><li>2.输出第一个数据报 </li><li>3.断开套接字连接； </li><li>4.连接套接字， </li><li>5.输出第二个数据报； </li><li>6.断开套接字连接 </li></ul><p>已连接套接字发送两个数据报的导致内核执行如下步骤； </p><ul><li>1.连接套接字； </li><li>2.输出第一个数据报； </li><li>3.输出第二个数据报。 </li></ul><p>对同一套接字发送时，某种程度上来讲，耗时减少1/3 </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;组播IP地址的使用范围规定&quot;&gt;&lt;a href=&quot;#组播IP地址的使用范围规定&quot; class=&quot;headerlink&quot; title=&quot;组播IP地址的使用范围规定&quot;&gt;&lt;/a&gt;组播IP地址的使用范围规定&lt;/h4&gt;&lt;p&gt;组播报文的目的地址使用 d 类 ip 地址，d 类地
      
    
    </summary>
    
      <category term="技术" scheme="http://www.lomelee.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="net" scheme="http://www.lomelee.com/tags/net/"/>
    
      <category term="c++" scheme="http://www.lomelee.com/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>理解字符集和编码</title>
    <link href="http://www.lomelee.com/2011/05/01/chartset/"/>
    <id>http://www.lomelee.com/2011/05/01/chartset/</id>
    <published>2011-05-01T10:02:05.000Z</published>
    <updated>2011-05-01T10:02:05.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="理解字符集和编码"><a href="#理解字符集和编码" class="headerlink" title="理解字符集和编码"></a>理解字符集和编码</h2><p>  工作中一直遇到这样字符编码的问题, 做了写个总结, 方便理解</p><ul><li>字符集<br>字符集顾名思义，是表示字符的集合。</li></ul><ul><li>编码<br>对字符集的编码。</li></ul><ul><li>什么时候说编码<br>字符串本身不存在什么编码<br>当这个字符串要被存储或者在网络上传递，需要转成二进制的字节流，这时候才会使用到UTF-8,GBK这些编码。</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;理解字符集和编码&quot;&gt;&lt;a href=&quot;#理解字符集和编码&quot; class=&quot;headerlink&quot; title=&quot;理解字符集和编码&quot;&gt;&lt;/a&gt;理解字符集和编码&lt;/h2&gt;&lt;p&gt;  工作中一直遇到这样字符编码的问题, 做了写个总结, 方便理解&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
      
    
    </summary>
    
      <category term="技术" scheme="http://www.lomelee.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="web" scheme="http://www.lomelee.com/tags/web/"/>
    
  </entry>
  
</feed>
